(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function s(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(e){if(e.ep)return;e.ep=!0;const n=s(e);fetch(e.href,n)}})();const i=document.getElementById("ask"),u=document.getElementById("askLabel"),m=document.getElementById("spinner"),h=document.getElementById("question"),f=document.querySelectorAll(".src-btn");let g="both";const y=document.getElementById("answerCard"),v=document.getElementById("output"),p=document.getElementById("sourceList"),B=document.getElementById("recentList"),b=document.getElementById("share"),w=document.getElementById("good"),I=document.getElementById("bad");let a="",r="";f.forEach(t=>{t.addEventListener("click",()=>{f.forEach(o=>o.classList.remove("active")),t.classList.add("active"),g=t.dataset.sourceMode})});document.querySelector('[data-source-mode="both"]').classList.add("active");async function E(){const t=h.value.trim();if(!t)return;i.disabled=!0,u.classList.add("hidden"),m.classList.remove("hidden"),y.classList.add("hidden");const o=g;try{const s=await fetch("/qa",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t,mode:o})});if(!s.ok)throw new Error(await s.text());const{answer:c,sources:e}=await s.json();v.textContent=c.trim(),a=t,r=c.trim();const n=document.createElement("li");n.textContent=t,B.prepend(n),p.innerHTML="",e.forEach(d=>{const l=document.createElement("li");l.textContent=d,p.appendChild(l)}),y.classList.remove("hidden")}catch(s){alert("Error: "+s.message)}finally{m.classList.add("hidden"),u.classList.remove("hidden"),i.disabled=!1}}i.addEventListener("click",E);h.addEventListener("keydown",t=>{t.key==="Enter"&&(t.metaKey||t.ctrlKey)&&E()});b.addEventListener("click",()=>{r&&(navigator.share?navigator.share({text:r}):(navigator.clipboard.writeText(r),alert("Answer copied to clipboard")))});function L(t){!a||!r||fetch("/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:a,answer:r,positive:t>0})})}w.addEventListener("click",()=>L(1));I.addEventListener("click",()=>L(-1));
